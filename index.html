<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base - Buy & Sell Bitcoin, Ethereum, and more with trust</title>
    <style>
        /* ... [keep all your previous CSS] ... */
        /* [The full CSS block from your message is here, unchanged] */
        /* MODAL STYLES (extra for forgot modal) */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; z-index: 2000; }
        .modal-overlay.active { display: flex; }
        .modal { background: #fff; border-radius: 16px; box-shadow: 0 8px 40px rgba(0,0,0,0.15); max-width: 400px; width: 95%; padding: 2.5rem 2rem; position: relative; animation: fadeInUp 0.4s cubic-bezier(.25,.8,.25,1);}
        .modal-close { position: absolute; right: 1.2rem; top: 1.2rem; font-size: 1.25rem; color: #999; background: none; border: none; cursor: pointer; z-index: 10; }
        .go-back-home { position: absolute; left: 1.2rem; top: 1.2rem; background: transparent; border: none; color: #0052ff; font-weight: 600; font-size: 1.04rem; cursor: pointer; padding: 0; z-index: 12;}
        .modal h2 { text-align: center; font-size: 1.5rem; font-weight: bold; color: #1652f0; margin-bottom: 1rem;}
        .modal form { display: flex; flex-direction: column; gap: 1.2rem;}
        .modal .btn-primary { width: 100%; padding: 0.8rem 0; font-size: 1.08rem; margin-top: 0.3rem;}
        .modal .error-message { color: #e11d48; text-align: left; font-size: 0.96rem; margin-top: -0.6rem;}
    </style>
</head>
<body>
    <!-- [Header, Hero, Features, Stats, CTA, Footer as in your file] -->

    <!-- SIGN IN MODAL -->
    <div class="modal-overlay" id="signInModal">
        <div class="modal">
            <button class="go-back-home" id="goBackHome" title="Go back to Homepage">&larr; Home</button>
            <button class="modal-close" id="closeSignInModal" title="Close">&times;</button>
            <h2>Sign in to Base</h2>
            <form id="signInForm" autocomplete="off">
                <div>
                    <label for="signin-email">Email address</label>
                    <input type="email" id="signin-email" name="email" required placeholder="your@email.com" />
                    <div id="emailError" class="error-message"></div>
                </div>
                <div>
                    <label for="signin-password">Password</label>
                    <input type="password" id="signin-password" name="password" required minlength="8" placeholder="Password" />
                    <div id="passwordError" class="error-message"></div>
                </div>
                <button type="submit" class="btn btn-primary" id="signInBtn">Sign in</button>
                <div id="signInSuccess" style="color: #10b981; text-align:center; margin-top:10px; display:none;"></div>
                <div id="signInFail" style="color: #e11d48; text-align:center; margin-top:10px; display:none;"></div>
                <a href="#" class="forgot-link" id="openForgotPasswordModal">Forgot your password?</a>
                <a href="#" class="signup-link" id="openSignUpModalFromSignIn">Don't have an account? Sign up</a>
            </form>
        </div>
    </div>

    <!-- SIGN UP MODAL -->
    <div class="modal-overlay" id="signUpModal">
        <div class="modal">
            <button class="go-back-home" id="goBackHomeSignUp" title="Go back to Homepage">&larr; Home</button>
            <button class="modal-close" id="closeSignUpModal" title="Close">&times;</button>
            <h2>Create your account</h2>
            <form id="signUpForm" autocomplete="off">
                <div>
                    <label for="signup-fullname">Full name</label>
                    <input type="text" id="signup-fullname" name="fullname" required placeholder="Enter your full name" />
                    <div id="fullnameError" class="error-message"></div>
                </div>
                <div>
                    <label for="signup-email">Email address</label>
                    <input type="email" id="signup-email" name="email" required placeholder="your@email.com" />
                    <div id="signupEmailError" class="error-message"></div>
                </div>
                <div>
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" name="password" required minlength="8" placeholder="Create a password (8+ characters)" />
                    <div id="signupPasswordError" class="error-message"></div>
                </div>
                <div>
                    <label for="signup-confirm-password">Confirm password</label>
                    <input type="password" id="signup-confirm-password" name="confirmPassword" required minlength="8" placeholder="Confirm your password" />
                    <div id="confirmPasswordError" class="error-message"></div>
                </div>
                <button type="submit" class="btn btn-primary" id="signUpBtn">Create account</button>
                <div id="signUpSuccess" style="color: #10b981; text-align:center; margin-top:10px; display:none;"></div>
                <div id="signUpFail" style="color: #e11d48; text-align:center; margin-top:10px; display:none;"></div>
                <a href="#" class="signup-link" id="openSignInModalFromSignUp">Already have an account? Sign in</a>
            </form>
        </div>
    </div>

    <!-- FORGOT PASSWORD MODAL -->
    <div class="modal-overlay" id="forgotPasswordModal">
        <div class="modal">
            <button class="go-back-home" id="goBackHomeForgot" title="Go back to Homepage">&larr; Home</button>
            <button class="modal-close" id="closeForgotPasswordModal" title="Close">&times;</button>
            <h2>Reset your password</h2>
            <form id="forgotPasswordForm" autocomplete="off">
                <div>
                    <label for="forgot-email">Email address</label>
                    <input type="email" id="forgot-email" name="email" required placeholder="your@email.com" />
                    <div id="forgotEmailError" class="error-message"></div>
                </div>
                <div>
                    <label for="forgot-password">New password</label>
                    <input type="password" id="forgot-password" name="password" required minlength="8" placeholder="New password" />
                    <div id="forgotPasswordError" class="error-message"></div>
                </div>
                <div>
                    <label for="forgot-confirm-password">Confirm new password</label>
                    <input type="password" id="forgot-confirm-password" name="confirmPassword" required minlength="8" placeholder="Confirm new password" />
                    <div id="forgotConfirmPasswordError" class="error-message"></div>
                </div>
                <button type="submit" class="btn btn-primary" id="forgotPasswordBtn">Reset password</button>
                <div id="forgotPasswordSuccess" style="color:#10b981; text-align:center; margin-top:10px; display:none;"></div>
                <div id="forgotPasswordFail" style="color:#e11d48; text-align:center; margin-top:10px; display:none;"></div>
            </form>
        </div>
    </div>

<script>
// --- OPEN & CLOSE MODALS ---
function openModal(el) { el.classList.add('active'); }
function closeModal(el) { el.classList.remove('active'); }
const openSignInModalBtn = document.getElementById('openSignInModal');
const openSignUpModalDesktop = document.getElementById('openSignUpModalDesktop');
const openSignUpModalMobile = document.getElementById('openSignUpModalMobile');
const openSignUpModalHero = document.getElementById('openSignUpModalHero');
const openSignUpModalCta = document.getElementById('openSignUpModalCta');
const signInModal = document.getElementById('signInModal');
const signUpModal = document.getElementById('signUpModal');
const forgotPasswordModal = document.getElementById('forgotPasswordModal');
const openSignUpModalFromSignIn = document.getElementById('openSignUpModalFromSignIn');
const openSignInModalFromSignUp = document.getElementById('openSignInModalFromSignUp');
const closeSignInModalBtn = document.getElementById('closeSignInModal');
const closeSignUpModalBtn = document.getElementById('closeSignUpModal');
const closeForgotPasswordModalBtn = document.getElementById('closeForgotPasswordModal');
const goBackHomeBtn = document.getElementById('goBackHome');
const goBackHomeSignUpBtn = document.getElementById('goBackHomeSignUp');
const goBackHomeForgot = document.getElementById('goBackHomeForgot');
const openForgotPasswordModal = document.getElementById('openForgotPasswordModal');
const modalOverlay = signInModal; // for legacy resets

// Sign in
openSignInModalBtn.onclick = e => { e.preventDefault(); openModal(signInModal); };
openSignUpModalDesktop.onclick = e => { e.preventDefault(); openModal(signUpModal); };
openSignUpModalMobile.onclick = e => { e.preventDefault(); openModal(signUpModal); };
openSignUpModalHero.onclick = e => { e.preventDefault(); openModal(signUpModal); };
openSignUpModalCta.onclick = e => { e.preventDefault(); openModal(signUpModal); };
openSignUpModalFromSignIn.onclick = e => { e.preventDefault(); closeModal(signInModal); openModal(signUpModal); };
openSignInModalFromSignUp.onclick = e => { e.preventDefault(); closeModal(signUpModal); openModal(signInModal); };

// Forgot password modal
openForgotPasswordModal.onclick = e => { e.preventDefault(); closeModal(signInModal); openModal(forgotPasswordModal); };

// Close modal logic
closeSignInModalBtn.onclick = goBackHomeBtn.onclick = () => { closeModal(signInModal); document.getElementById('signInForm').reset(); clearSignInErrors(); };
closeSignUpModalBtn.onclick = goBackHomeSignUpBtn.onclick = () => { closeModal(signUpModal); document.getElementById('signUpForm').reset(); clearSignUpErrors(); };
closeForgotPasswordModalBtn.onclick = goBackHomeForgot.onclick = () => { closeModal(forgotPasswordModal); document.getElementById('forgotPasswordForm').reset(); clearForgotPasswordErrors(); };
[signInModal, signUpModal, forgotPasswordModal].forEach(modal =>
    modal.addEventListener('click', e => { if (e.target === modal) closeModal(modal); })
);
window.addEventListener('keydown', function(e) {
    if (e.key === "Escape") [signInModal, signUpModal, forgotPasswordModal].forEach(m => closeModal(m));
});

// --- FORM VALIDATIONS, SHEETDB CONNECTIONS ---

// SIGN UP
function clearSignUpErrors() {
    document.getElementById('fullnameError').textContent = "";
    document.getElementById('signupEmailError').textContent = "";
    document.getElementById('signupPasswordError').textContent = "";
    document.getElementById('confirmPasswordError').textContent = "";
    document.getElementById('signUpSuccess').style.display = "none";
    document.getElementById('signUpFail').style.display = "none";
}
document.getElementById('signUpForm').onsubmit = function(e) {
    e.preventDefault();
    clearSignUpErrors();
    let hasError = false;
    const fullname = document.getElementById('signup-fullname').value.trim();
    const email = document.getElementById('signup-email').value.trim();
    const password = document.getElementById('signup-password').value;
    const confirmPassword = document.getElementById('signup-confirm-password').value;
    if (!fullname) { document.getElementById('fullnameError').textContent = "Full name is required"; hasError = true; }
    if (!email) { document.getElementById('signupEmailError').textContent = "Email is required"; hasError = true; }
    else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { document.getElementById('signupEmailError').textContent = "Enter a valid email address"; hasError = true; }
    if (!password) { document.getElementById('signupPasswordError').textContent = "Password is required"; hasError = true; }
    else if (password.length < 8) { document.getElementById('signupPasswordError').textContent = "Password must be at least 8 characters"; hasError = true; }
    if (!confirmPassword) { document.getElementById('confirmPasswordError').textContent = "Please confirm your password"; hasError = true; }
    else if (password !== confirmPassword) { document.getElementById('confirmPasswordError').textContent = "Passwords do not match"; hasError = true; }
    if (!hasError) {
        const btn = document.getElementById('signUpBtn');
        btn.textContent = "Creating account...";
        btn.disabled = true;
        fetch("https://sheetdb.io/api/v1/sbath1xpp3h1u", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                data: [{ fullname, email, password }]
            })
        }).then(res => res.ok ? res.json() : Promise.reject(res))
        .then(() => {
            btn.textContent = "Create account";
            btn.disabled = false;
            document.getElementById('signUpSuccess').textContent = "Account created! You can now sign in.";
            document.getElementById('signUpSuccess').style.display = "block";
            setTimeout(() => { closeModal(signUpModal); document.getElementById('signUpForm').reset(); clearSignUpErrors(); openModal(signInModal); }, 2000);
        })
        .catch(() => {
            btn.textContent = "Create account";
            btn.disabled = false;
            document.getElementById('signUpFail').textContent = "Sign up failed. Try again.";
            document.getElementById('signUpFail').style.display = "block";
        });
    }
};

// SIGN IN
function clearSignInErrors() {
    document.getElementById('emailError').textContent = "";
    document.getElementById('passwordError').textContent = "";
    document.getElementById('signInSuccess').style.display = "none";
    document.getElementById('signInFail').style.display = "none";
}
document.getElementById('signInForm').onsubmit = function(e) {
    e.preventDefault();
    clearSignInErrors();
    let hasError = false;
    const email = document.getElementById('signin-email').value.trim();
    const password = document.getElementById('signin-password').value;
    if (!email) { document.getElementById('emailError').textContent = "Email is required"; hasError = true; }
    else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { document.getElementById('emailError').textContent = "Enter a valid email address"; hasError = true; }
    if (!password) { document.getElementById('passwordError').textContent = "Password is required"; hasError = true; }
    else if (password.length < 8) { document.getElementById('passwordError').textContent = "Password must be at least 8 characters"; hasError = true; }
    if (!hasError) {
        const btn = document.getElementById('signInBtn');
        btn.textContent = "Signing in...";
        btn.disabled = true;
        fetch(`https://sheetdb.io/api/v1/sbath1xpp3h1u/search?email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`)
            .then(res => res.json())
            .then(data => {
                btn.textContent = "Sign in";
                btn.disabled = false;
                if (Array.isArray(data) && data.length > 0) {
                    document.getElementById('signInSuccess').textContent = "Sign in successful! Redirecting...";
                    document.getElementById('signInSuccess').style.display = "block";
                    setTimeout(() => { window.location.href = "download.html"; }, 1200);
                } else {
                    document.getElementById('signInFail').textContent = "Incorrect email or password.";
                    document.getElementById('signInFail').style.display = "block";
                }
            })
            .catch(() => {
                btn.textContent = "Sign in";
                btn.disabled = false;
                document.getElementById('signInFail').textContent = "Sign in failed. Try again.";
                document.getElementById('signInFail').style.display = "block";
            });
    }
};

// FORGOT PASSWORD
function clearForgotPasswordErrors() {
    document.getElementById('forgotEmailError').textContent = "";
    document.getElementById('forgotPasswordError').textContent = "";
    document.getElementById('forgotConfirmPasswordError').textContent = "";
    document.getElementById('forgotPasswordSuccess').style.display = "none";
    document.getElementById('forgotPasswordFail').style.display = "none";
}
document.getElementById('forgotPasswordForm').onsubmit = function(e){
    e.preventDefault();
    clearForgotPasswordErrors();
    const email = document.getElementById('forgot-email').value.trim();
    const password = document.getElementById('forgot-password').value;
    const confirmPassword = document.getElementById('forgot-confirm-password').value;
    if (!email) { document.getElementById('forgotEmailError').textContent = "Email is required"; return; }
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { document.getElementById('forgotEmailError').textContent = "Invalid email"; return; }
    if (!password) { document.getElementById('forgotPasswordError').textContent = "New password is required"; return; }
    if (password.length < 8) { document.getElementById('forgotPasswordError').textContent = "Password must be at least 8 characters"; return; }
    if (!confirmPassword) { document.getElementById('forgotConfirmPasswordError').textContent = "Please confirm your password"; return; }
    if (password !== confirmPassword) { document.getElementById('forgotConfirmPasswordError').textContent = "Passwords do not match"; return; }
    const btn = document.getElementById('forgotPasswordBtn');
    btn.textContent = "Resetting...";
    btn.disabled = true;
    // Step 1: Check user exists
    fetch(`https://sheetdb.io/api/v1/sbath1xpp3h1u/search?email=${encodeURIComponent(email)}`)
        .then(r => r.json())
        .then(users => {
            if (!users[0]) throw new Error("Email not found.");
            // Step 2: PATCH password for this email
            return fetch(`https://sheetdb.io/api/v1/sbath1xpp3h1u/email/${encodeURIComponent(email)}`, {
                method: "PATCH",
                headers: {"Content-Type":"application/json"},
                body: JSON.stringify({ data: [{ password: password }] })
            });
        })
        .then(r => {
            btn.textContent = "Reset password";
            btn.disabled = false;
            if (r.ok) {
                document.getElementById('forgotPasswordSuccess').textContent = "Password reset! You can now log in.";
                document.getElementById('forgotPasswordSuccess').style.display = "block";
                setTimeout(() => { closeModal(forgotPasswordModal); document.getElementById('forgotPasswordForm').reset(); openModal(signInModal); }, 1600);
            } else {
                throw new Error("Failed to reset password. Try again.");
            }
        })
        .catch(err => {
            btn.textContent = "Reset password";
            btn.disabled = false;
            document.getElementById('forgotPasswordFail').textContent = err.message || "Password reset failed. Try again.";
            document.getElementById('forgotPasswordFail').style.display = "block";
        });
};
</script>
</body>
</html>
